{"ast":null,"code":"var _jsxFileName = \"/Users/satoshiaikawa/react-mui-bookstore-k8s/src/Checkout.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { styled } from '@mui/material/styles';\nimport { Box, Button, Checkbox, Link, Typography, Container, FormControlLabel, CssBaseline, ThemeProvider, TextField, Paper, Grid, Divider, InputLabel, Select, MenuItem } from '@mui/material';\nimport ModalUnstyled from '@mui/base/ModalUnstyled';\nimport { commerce } from './lib/commerce';\nimport { Elements, CardElement, ElementsConsumer } from '@stripe/react-stripe-js';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY);\nconst Item = styled(Paper)(_ref => {\n  let {\n    theme\n  } = _ref;\n  return {\n    backgroundColor: theme.palette.mode === 'dark' ? '#1A2027' : '#fff',\n    ...theme.typography.body2,\n    padding: theme.spacing(1),\n    textAlign: 'center',\n    color: theme.palette.text.secondary\n  };\n});\n/*\ncurl -X GET \\\n    -G \"https://api.chec.io/v1/products/prod_RqEv5xzL10wZz4/variants\" \\\n    -H \"X-Authorization: sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\" | jq .\n\n\ncurl -X GET \\\n    -G \"https://api.chec.io/v1/products/prod_RqEv5xzL10wZz4/variant_groups\" \\\n    -H \"X-Authorization: sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\" | jq .\n\n// add by variant\n\ncurl -X POST \\\n    \"https://api.chec.io/v1/carts/cart_7ZAMo1XpEMwNJ4\" \\\n    -H \"X-Authorization: sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\"id\":\"prod_Op1YoVEALgwXLv\",\"variant_id\":\"vrnt_LvJjoPbObRle0n\"}'\n*/\n\n_c = Item;\nexport default function Checkout() {\n  _s();\n\n  const [firstname, setFirstname] = useState('');\n  const [lastname, setLastname] = useState('');\n  const [email, setEmail] = useState('');\n  const [address1, setAddress1] = useState('');\n  const [shippingCountries, setShippingCountries] = useState([]);\n  const [shippingCountry, setShippingCountry] = useState('');\n  const [shippingSubdivisions, setShippingSubdivisions] = useState([]);\n  const [shippingSubdivision, setShippingSubdivision] = useState(''); // handleCheckout\n\n  const [errorMessage, setErrorMessage] = useState('');\n  const [customer, setCustomer] = useState(undefined);\n  const [cart, setCart] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [checkoutToken, setCheckoutToken] = useState(null);\n\n  const handleSubmit = async (event, elements, stripe) => {\n    //現在のURLに対してフォームの送信が行われると、結果的にページがリロードされてしまいます。 \n    //そのため、event.preventDefault()を呼び出し、デフォルトの動作をキャンセルしていました。 \n    //event.preventDefault()をコメントアウトすると、ページがリロードされてしまうことが確認できます。\n    event.preventDefault();\n    if (!stripe || !elements) return;\n    const cardElement = elements.getElement(CardElement);\n    const {\n      error,\n      paymentMethod\n    } = await stripe.createPaymentMethod({\n      type: 'card',\n      card: cardElement\n    });\n    console.log({\n      error,\n      paymentMethod\n    });\n\n    if (error) {\n      console.log('[error]', error);\n    } else {\n      // required fields\n      // https://commercejs.com/docs/api/?javascript--cjs#capture-order\n      const orderData = {\n        line_items: checkoutToken.live.line_items,\n        customer: {\n          firstname: 'aa',\n          lastname: 'bb',\n          email: 'example@qq.com'\n        },\n        //shipping: { name: 'International', street: shippingData.address1, town_city: shippingData.city, county_state: shippingData.shippingSubdivision, postal_zip_code: shippingData.zip, country: shippingData.shippingCountry },\n        //fulfillment: { shipping_method: shippingData.shippingOption },\n        payment: {\n          // Test Gateway is enabled by default, and is used when you submit orders with\n          // your sandbox API key\n          gateway: 'test_gateway',\n          card: {\n            number: '4242 4242 4242 4242',\n            expiry_month: '01',\n            expiry_year: '2023',\n            cvc: '123',\n            postal_zip_code: '94103'\n          }\n        }\n        /*\n        payment: {\n          gateway: 'stripe',\n          stripe: {\n            payment_method_id: paymentMethod.id,\n          },\n        },\n        \n        \n        */\n\n      };\n      handleCaptureCheckout(checkoutToken.id, orderData);\n    }\n  };\n\n  useEffect(() => {\n    const fetchCart = async () => {\n      // Retrieve the customers current cart (tracked by their browser)\n      await commerce.cart.retrieve().then(cart => {\n        console.log(cart); //console.log(JSON.stringify(cart, null, 2))\n\n        setCart(cart); // generate checkoutToken from current cart\n\n        if (cart.id) {\n          const generateCheckoutToken = async () => {\n            try {\n              // Generate a token from the cart that was previously created or retrieved\n              const token = await commerce.checkout.generateToken(cart.id, {\n                type: 'cart'\n              });\n              setCheckoutToken(token);\n              console.log(token);\n            } catch {\n              console.log(\"checkout token generation failed\");\n            }\n          };\n\n          generateCheckoutToken();\n        }\n      });\n    };\n\n    fetchCart();\n    console.log(cart);\n    let customerId = localStorage.getItem('token');\n    console.log(customerId);\n    customerId = customerId.substring(1, customerId.length - 1);\n    console.log(customerId);\n    const url = new URL(\"https://api.chec.io/v1/customers/\" + customerId);\n    let headers = {\n      \"X-Authorization\": \"sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\",\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\"\n    };\n    fetch(url, {\n      method: \"GET\",\n      headers: headers\n    }).then(response => response.json()).then(json => {\n      console.log(json);\n      setCustomer(json);\n      setFirstname(json.firstname);\n      setLastname(json.lastname);\n      setEmail(json.email);\n      setLoading(false);\n    });\n  }, []); // [] is for useEffectをマウント時に1回だけ実行する方法\n\n  const handleCaptureCheckout = async (checkoutTokenId, newOrder) => {\n    try {\n      // Captures an order and payment by converting a checkout token and necessary data into an order object, and charging all related transactions.\n      const incomingOrder = await commerce.checkout.capture(checkoutTokenId, newOrder);\n      console.log(incomingOrder); // TODO create new cart and add to auth API\n\n      const createCart = async () => {\n        // Retrieve the customers current cart (tracked by their browser)\n        await commerce.cart.refresh().then(cart => {\n          console.log(cart);\n          localStorage.setItem('cart_id', cart.id);\n          const customerId = localStorage.getItem('token');\n          const url3 = new URL(\"http://localhost:3002/api/cart/\" + customerId + \"/\" + cart.id);\n          let headers3 = {\n            \"Content-Type\": \"application/json  charset=UTF-8\",\n            \"Accept\": \"application/json\"\n          };\n          fetch(url3, {\n            method: \"GET\",\n            headers: headers3\n          }).then(response => response.json()).then(json => {\n            console.log(json);\n          });\n        });\n      };\n\n      createCart();\n    } catch (error) {\n      setErrorMessage(error.data.error.message);\n    }\n  };\n\n  if (loading) return \"loading\";\n  if ((cart === null || cart === void 0 ? void 0 : cart.id) === undefined) return 'cart loading';\n  if ((checkoutToken === null || checkoutToken === void 0 ? void 0 : checkoutToken.live) === undefined) return 'token loading';\n  return /*#__PURE__*/_jsxDEV(Paper, {\n    elevation: 0,\n    sx: {\n      flexGrow: 1,\n      backgroundColor: theme => theme.palette.mode === 'dark' ? '#1A2027' : '#fff'\n    },\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 0,\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 7,\n        children: [/*#__PURE__*/_jsxDEV(Item, {\n          elevation: 0,\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            component: \"form\",\n            noValidate: true,\n            onSubmit: handleSubmit,\n            container: true,\n            spacing: 2,\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            children: [/*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 6,\n              md: 12,\n              children: /*#__PURE__*/_jsxDEV(Item, {\n                elevation: 0,\n                children: /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h5\",\n                  children: \"\\u304A\\u5C4A\\u3051\\u5148\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 30\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              sm: 12,\n              children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                id: \"demo-simple-select-label\",\n                children: \"\\u56FD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(Select, {\n                value: shippingCountry,\n                fullWidth: true,\n                onChange: e => setShippingCountry(e.target.value),\n                id: \"demo-simple-select\",\n                label: \"Age\",\n                children: Object.entries(shippingCountries).map(_ref2 => {\n                  let [code, name] = _ref2;\n                  return {\n                    id: code,\n                    label: name\n                  };\n                }).map(item => /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: item.id,\n                  children: item.label\n                }, item.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 19\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              sm: 12,\n              children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                id: \"demo-simple-select-label\",\n                children: \"\\u90FD\\u9053\\u5E9C\\u770C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(Select, {\n                value: shippingSubdivision,\n                fullWidth: true,\n                onChange: e => setShippingSubdivision(e.target.value),\n                labelId: \"demo-simple-select-label\",\n                id: \"demo-simple-select\",\n                label: \"Age\",\n                children: Object.entries(shippingSubdivisions).map(_ref3 => {\n                  let [code, name] = _ref3;\n                  return {\n                    id: code,\n                    label: name\n                  };\n                }).map(item => /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: item.id,\n                  children: item.label\n                }, item.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 19\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              sm: 4,\n              children: /*#__PURE__*/_jsxDEV(TextField, {\n                required: true,\n                fullWidth: true,\n                id: \"address1\",\n                label: \"\\u90F5\\u4FBF\\u756A\\u53F7\",\n                name: \"address1\",\n                onChange: e => setEmail(e.target.value),\n                helperText: \"Enter your email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              sm: 8,\n              children: /*#__PURE__*/_jsxDEV(TextField, {\n                required: true,\n                fullWidth: true,\n                id: \"address1\",\n                label: \"\\u4F4F\\u6240\",\n                name: \"address1\",\n                onChange: e => setEmail(e.target.value),\n                helperText: \"Enter your email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 271,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 6,\n              md: 12,\n              children: /*#__PURE__*/_jsxDEV(Item, {\n                elevation: 0,\n                children: /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h5\",\n                  children: \"\\u3054\\u9023\\u7D61\\u5148\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 30\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              sm: 12,\n              children: /*#__PURE__*/_jsxDEV(TextField, {\n                required: true,\n                fullWidth: true,\n                id: \"lastname\",\n                label: \"\\u59D3\",\n                name: \"lastname\",\n                defaultValue: lastname,\n                onChange: e => setEmail(e.target.value),\n                helperText: \"Enter your email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              sm: 12,\n              children: /*#__PURE__*/_jsxDEV(TextField, {\n                autoComplete: \"given-name\",\n                name: \"firstname\",\n                required: true,\n                fullWidth: true,\n                id: \"firstname\",\n                label: \"\\u540D\",\n                defaultValue: firstname,\n                onChange: e => setEmail(e.target.value),\n                helperText: \"Enter your email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              children: /*#__PURE__*/_jsxDEV(TextField, {\n                required: true,\n                fullWidth: true,\n                id: \"email\",\n                label: \"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\\uFF08Gmail\\u7B49\\u306E\\u30D5\\u30EA\\u30FC\\u30E1\\u30FC\\u30EB\\u63A8\\u5968\\uFF09\",\n                name: \"email\",\n                defaultValue: email,\n                onChange: e => setEmail(e.target.value),\n                helperText: \"Enter your email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          md: 12,\n          children: /*#__PURE__*/_jsxDEV(Item, {\n            elevation: 0,\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h5\",\n              children: \"\\u304A\\u652F\\u6255\\u3044\\u65B9\\u6CD5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 30\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          md: 12,\n          children: /*#__PURE__*/_jsxDEV(Item, {\n            elevation: 0,\n            children: /*#__PURE__*/_jsxDEV(Elements, {\n              stripe: stripePromise,\n              children: /*#__PURE__*/_jsxDEV(ElementsConsumer, {\n                children: _ref4 => {\n                  let {\n                    elements,\n                    stripe\n                  } = _ref4;\n                  return /*#__PURE__*/_jsxDEV(\"form\", {\n                    onSubmit: e => handleSubmit(e, elements, stripe),\n                    children: [/*#__PURE__*/_jsxDEV(CardElement, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 337,\n                      columnNumber: 13\n                    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 338,\n                      columnNumber: 13\n                    }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 338,\n                      columnNumber: 20\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        display: 'flex',\n                        justifyContent: 'space-between'\n                      },\n                      children: /*#__PURE__*/_jsxDEV(Button, {\n                        fullWidth: true,\n                        type: \"submit\",\n                        variant: \"contained\",\n                        disabled: !stripe,\n                        style: {\n                          backgroundColor: '#1C2331',\n                          color: '#FFFF',\n                          height: 60\n                        },\n                        children: [\"\\u652F\\u6255\\u3046 \", checkoutToken.live.subtotal.formatted_with_symbol]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 340,\n                        columnNumber: 15\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 339,\n                      columnNumber: 13\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 336,\n                    columnNumber: 11\n                  }, this);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 335,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 334,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 5,\n        children: /*#__PURE__*/_jsxDEV(Item, {\n          elevation: 0,\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 6,\n            md: 12,\n            children: /*#__PURE__*/_jsxDEV(Item, {\n              elevation: 0,\n              children: /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h5\",\n                children: \"\\u8CFC\\u5165\\u3059\\u308B\\u30A2\\u30A4\\u30C6\\u30E0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 30\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Divider, {\n            sx: {\n              margin: '10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 6,\n            md: 12,\n            children: /*#__PURE__*/_jsxDEV(Item, {\n              elevation: 0,\n              children: /*#__PURE__*/_jsxDEV(ModalUnstyledDemo, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 30\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 6,\n            md: 12,\n            children: /*#__PURE__*/_jsxDEV(Item, {\n              elevation: 0,\n              children: /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h5\",\n                children: [\"\\u5408\\u8A08:      JPY \\uFFE56,100\", cart.subtotal.formatted_with_symbol]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 30\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Divider, {\n            sx: {\n              margin: '10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 218,\n    columnNumber: 5\n  }, this);\n} // for testing form fubmission\n\n_s(Checkout, \"dLY4tI4/HJ9m6j4Dy+ynZ0eIURk=\");\n\n_c2 = Checkout;\n\nconst handleSubmit = event => {\n  event.preventDefault();\n  const data = new FormData(event.currentTarget); // eslint-disable-next-line no-console\n\n  console.log({\n    email: data.get('email'),\n    password: data.get('password')\n  });\n};\n\nconst StyledModal = styled(ModalUnstyled)`\n  position: fixed;\n  z-index: 1300;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n_c3 = StyledModal;\nconst Backdrop = styled('div')`\n  z-index: -1;\n  position: fixed;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  left: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  -webkit-tap-highlight-color: transparent;\n`;\nconst style = {\n  width: 400,\n  bgcolor: 'background.paper',\n  p: 2,\n  px: 4,\n  pb: 3\n};\n\nfunction ModalUnstyledDemo() {\n  _s2();\n\n  const [open, setOpen] = React.useState(false);\n\n  const handleOpen = () => setOpen(true);\n\n  const handleClose = () => setOpen(false);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      variant: \"outlined\",\n      type: \"button\",\n      onClick: handleOpen,\n      children: \"\\u914D\\u9001\\u306B\\u3064\\u3044\\u3066\\uD83D\\uDE9A\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(StyledModal, {\n      \"aria-labelledby\": \"unstyled-modal-title\",\n      \"aria-describedby\": \"unstyled-modal-description\",\n      open: open,\n      onClose: handleClose,\n      BackdropComponent: Backdrop,\n      children: /*#__PURE__*/_jsxDEV(Paper, {\n        sx: style,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          id: \"unstyled-modal-title\",\n          children: \"\\u914D\\u9001\\u30DD\\u30EA\\u30B7\\u30FC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"unstyled-modal-description\",\n          children: \"\\u3054\\u6CE8\\u6587\\u304B\\u3089\\u304A\\u5C4A\\u3051\\u307E\\u3067\\u306E\\u6D41\\u308C\\uD83D\\uDE9A STEP1. \\u5546\\u54C1\\u306E\\u304A\\u624B\\u914D\\uFF08\\u6CE8\\u6587\\u5F8C4~6\\u55B6\\u696D\\u65E5\\uFF09 \\u3054\\u6CE8\\u6587\\uFF08\\u5165\\u91D1\\u78BA\\u8A8D\\uFF09\\u5B8C\\u4E86\\u5F8C\\u3001\\u7FCC\\u55B6\\u696D\\u65E5\\u306B\\u30E1\\u30FC\\u30AB\\u30FC\\u3078\\u767A\\u6CE8 \\u2192\\u5546\\u54C1\\u3092\\u691C\\u54C1\\u3057\\u3001\\u4E01\\u5BE7\\u306B\\u5305\\u88C5\\u30FB\\u68B1\\u5305\\u3057\\u3066\\u767A\\u9001\\u306E\\u6E96\\u5099\\u3092\\u3057\\u3066\\u3044\\u304D\\u307E\\u3059 STEP2. \\u6D77\\u5916\\u304B\\u3089\\u56FD\\u5185\\u5009\\u5EAB\\u3078\\u5411\\u3051\\u3066\\u5546\\u54C1\\u3092\\u767A\\u9001\\uFF08\\u6CE8\\u6587\\u5F8C7~10\\u55B6\\u696D\\u65E5\\uFF09 \\u6D77\\u5916\\u306E\\u767A\\u9001\\u62E0\\u70B9\\u304B\\u3089\\u7A0E\\u95A2\\u3092\\u901A\\u308A\\u3001\\u65E5\\u672C\\u3078\\u5411\\u3051\\u3066\\u7A7A\\u8F38 \\u2192\\u65E5\\u672C\\u306B\\u5230\\u7740\\u5F8C\\u3001\\u518D\\u3073\\u7A0E\\u95A2\\u3092\\u901A\\u308A\\u3001\\u56FD\\u5185\\u5009\\u5EAB\\u3078\\u8F38\\u9001\\u3057\\u307E\\u3059 STEP3. \\u56FD\\u5185\\u5009\\u5EAB\\u304B\\u3089\\u767A\\u9001\\uFF08\\u6CE8\\u6587\\u5F8C14~26\\u55B6\\u696D\\u65E5\\uFF09 \\u5009\\u5EAB\\u306B\\u5546\\u54C1\\u304C\\u5230\\u7740\\u5F8C\\u3001\\u518D\\u3073\\u554F\\u984C\\u304C\\u306A\\u3044\\u304B\\u5FF5\\u5165\\u308A\\u306B\\u691C\\u54C1\\u3092\\u3057\\u3066\\u68B1\\u5305 \\u2192\\u914D\\u9001\\u696D\\u8005\\u3092\\u901A\\u3057\\u3066\\u304A\\u5BA2\\u69D8\\u306E\\u3082\\u3068\\u3078\\u767A\\u9001\\u3057\\u307E\\u3059\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 443,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 430,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(ModalUnstyledDemo, \"xG1TONbKtDWtdOTrXaTAsNhPg/Q=\");\n\n_c4 = ModalUnstyledDemo;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"Item\");\n$RefreshReg$(_c2, \"Checkout\");\n$RefreshReg$(_c3, \"StyledModal\");\n$RefreshReg$(_c4, \"ModalUnstyledDemo\");","map":{"version":3,"sources":["/Users/satoshiaikawa/react-mui-bookstore-k8s/src/Checkout.js"],"names":["React","useState","useEffect","styled","Box","Button","Checkbox","Link","Typography","Container","FormControlLabel","CssBaseline","ThemeProvider","TextField","Paper","Grid","Divider","InputLabel","Select","MenuItem","ModalUnstyled","commerce","Elements","CardElement","ElementsConsumer","loadStripe","stripePromise","process","env","REACT_APP_STRIPE_PUBLIC_KEY","Item","theme","backgroundColor","palette","mode","typography","body2","padding","spacing","textAlign","color","text","secondary","Checkout","firstname","setFirstname","lastname","setLastname","email","setEmail","address1","setAddress1","shippingCountries","setShippingCountries","shippingCountry","setShippingCountry","shippingSubdivisions","setShippingSubdivisions","shippingSubdivision","setShippingSubdivision","errorMessage","setErrorMessage","customer","setCustomer","undefined","cart","setCart","loading","setLoading","checkoutToken","setCheckoutToken","handleSubmit","event","elements","stripe","preventDefault","cardElement","getElement","error","paymentMethod","createPaymentMethod","type","card","console","log","orderData","line_items","live","payment","gateway","number","expiry_month","expiry_year","cvc","postal_zip_code","handleCaptureCheckout","id","fetchCart","retrieve","then","generateCheckoutToken","token","checkout","generateToken","customerId","localStorage","getItem","substring","length","url","URL","headers","fetch","method","response","json","checkoutTokenId","newOrder","incomingOrder","capture","createCart","refresh","setItem","url3","headers3","data","message","flexGrow","e","target","value","Object","entries","map","code","name","label","item","display","justifyContent","height","subtotal","formatted_with_symbol","margin","FormData","currentTarget","get","password","StyledModal","Backdrop","style","width","bgcolor","p","px","pb","ModalUnstyledDemo","open","setOpen","handleOpen","handleClose"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { styled } from '@mui/material/styles';\nimport { Box, Button, Checkbox, Link, Typography, Container, FormControlLabel, CssBaseline, ThemeProvider, TextField, Paper, Grid, Divider,InputLabel, Select, MenuItem } from '@mui/material';\nimport ModalUnstyled from '@mui/base/ModalUnstyled';\n\nimport {commerce} from './lib/commerce'\n\nimport { Elements, CardElement, ElementsConsumer } from '@stripe/react-stripe-js';\nimport { loadStripe } from '@stripe/stripe-js';\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY);\n\nconst Item = styled(Paper)(({ theme }) => ({\n  backgroundColor: theme.palette.mode === 'dark' ? '#1A2027' : '#fff',\n  ...theme.typography.body2,\n  padding: theme.spacing(1),\n  textAlign: 'center',\n  color: theme.palette.text.secondary,\n}));\n\n/*\ncurl -X GET \\\n    -G \"https://api.chec.io/v1/products/prod_RqEv5xzL10wZz4/variants\" \\\n    -H \"X-Authorization: sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\" | jq .\n\n\ncurl -X GET \\\n    -G \"https://api.chec.io/v1/products/prod_RqEv5xzL10wZz4/variant_groups\" \\\n    -H \"X-Authorization: sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\" | jq .\n\n// add by variant\n\ncurl -X POST \\\n    \"https://api.chec.io/v1/carts/cart_7ZAMo1XpEMwNJ4\" \\\n    -H \"X-Authorization: sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\"id\":\"prod_Op1YoVEALgwXLv\",\"variant_id\":\"vrnt_LvJjoPbObRle0n\"}'\n*/\n\nexport default function Checkout() {\n  const [firstname, setFirstname] = useState('');\n  const [lastname, setLastname] = useState('');\n  const [email, setEmail] = useState('');\n  const [address1, setAddress1] = useState('');\n  const [shippingCountries, setShippingCountries] = useState([]);\n  const [shippingCountry, setShippingCountry] = useState('');\n  const [shippingSubdivisions, setShippingSubdivisions] = useState([]);\n  const [shippingSubdivision, setShippingSubdivision] = useState('');\n\n  // handleCheckout\n  const [errorMessage, setErrorMessage] = useState('')\n\n\n  const [ customer, setCustomer ] = useState(undefined)\n  const [cart, setCart] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  const [checkoutToken, setCheckoutToken] = useState(null);\n\n\n  const handleSubmit = async (event, elements, stripe) => {\n    //現在のURLに対してフォームの送信が行われると、結果的にページがリロードされてしまいます。 \n    //そのため、event.preventDefault()を呼び出し、デフォルトの動作をキャンセルしていました。 \n    //event.preventDefault()をコメントアウトすると、ページがリロードされてしまうことが確認できます。\n    event.preventDefault();\n\n    if (!stripe || !elements) return;\n\n    const cardElement = elements.getElement(CardElement);\n\n    const { error, paymentMethod } = await stripe.createPaymentMethod({ type: 'card', card: cardElement });\n    console.log({ error, paymentMethod })\n\n    if (error) {\n      console.log('[error]', error);\n    } else {\n      // required fields\n      // https://commercejs.com/docs/api/?javascript--cjs#capture-order\n      const orderData = {\n        line_items: checkoutToken.live.line_items,\n        customer: { firstname: 'aa', lastname: 'bb', email: 'example@qq.com' },\n        //shipping: { name: 'International', street: shippingData.address1, town_city: shippingData.city, county_state: shippingData.shippingSubdivision, postal_zip_code: shippingData.zip, country: shippingData.shippingCountry },\n        //fulfillment: { shipping_method: shippingData.shippingOption },\n        payment: {\n          // Test Gateway is enabled by default, and is used when you submit orders with\n          // your sandbox API key\n          gateway: 'test_gateway',\n          card: {\n            number: '4242 4242 4242 4242',\n            expiry_month: '01',\n            expiry_year: '2023',\n            cvc: '123',\n            postal_zip_code: '94103',\n          },\n        },\n        /*\n        payment: {\n          gateway: 'stripe',\n          stripe: {\n            payment_method_id: paymentMethod.id,\n          },\n        },\n        \n        \n        */\n      };\n\n      handleCaptureCheckout(checkoutToken.id, orderData);\n\n    }\n  };\n\n  useEffect(() => {\n    \n    const fetchCart = async () => {\n      // Retrieve the customers current cart (tracked by their browser)\n      await commerce.cart.retrieve().then(cart => {\n        console.log(cart)\n        //console.log(JSON.stringify(cart, null, 2))\n        setCart(cart)\n            // generate checkoutToken from current cart\n      if (cart.id) {\n      const generateCheckoutToken = async () => {\n        try {\n          // Generate a token from the cart that was previously created or retrieved\n          const token = await commerce.checkout.generateToken(cart.id, { type: 'cart' });\n          setCheckoutToken(token);\n          console.log(token)\n        } catch {\n          console.log(\"checkout token generation failed\")\n        }\n      };\n      generateCheckoutToken();\n\n    }\n      });\n    }\n    fetchCart();\n\n    console.log(cart)\n    let customerId=localStorage.getItem('token')\n    console.log(customerId)\n    customerId=customerId.substring(1,customerId.length-1)\n    console.log(customerId)\n    const url = new URL(\n      \"https://api.chec.io/v1/customers/\"+customerId\n  );\n  \n  let headers = {\n      \"X-Authorization\": \"sk_test_39980259115a0d9753812433d6740aa60b83dc9a64fba\",\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\",\n  };\n  \n  fetch(url, {\n      method: \"GET\",\n      headers: headers,\n  })\n      .then(response => response.json())\n      .then(json => {\n        console.log(json);\n        setCustomer(json);\n        setFirstname(json.firstname)\n        setLastname(json.lastname)\n        setEmail(json.email)\n        setLoading(false)\n      });\n\n  }, []) // [] is for useEffectをマウント時に1回だけ実行する方法\n\n\n\n\n  const handleCaptureCheckout = async (checkoutTokenId, newOrder) => {\n    try {\n      // Captures an order and payment by converting a checkout token and necessary data into an order object, and charging all related transactions.\n      const incomingOrder = await commerce.checkout.capture(checkoutTokenId, newOrder)\n      console.log(incomingOrder)\n      // TODO create new cart and add to auth API\n      const createCart = async () => {\n        // Retrieve the customers current cart (tracked by their browser)\n        await commerce.cart.refresh()\n        .then(cart => {\n            console.log(cart)\n            localStorage.setItem('cart_id', cart.id)\n            const customerId=localStorage.getItem('token')\n            const url3 = new URL(\n              \"http://localhost:3002/api/cart/\"+customerId+\"/\"+cart.id\n            );\n\n            let headers3 = {\n              \"Content-Type\": \"application/json  charset=UTF-8\",\n              \"Accept\": \"application/json\",\n            };\n            fetch(url3, {\n              method: \"GET\",\n              headers: headers3\n            })\n            .then(response => response.json())\n            .then(json => {\n                console.log(json);\n            });\n\n        });\n      }\n      createCart()\n    } catch (error) {\n      setErrorMessage(error.data.error.message)\n    }\n  }\n\n\n\n  if(loading)return \"loading\"\n  if(cart?.id===undefined)return 'cart loading'\n  if(checkoutToken?.live===undefined)return 'token loading'\n\n  return (\n    <Paper elevation={0} sx={{\n      flexGrow: 1,\n      backgroundColor: (theme) => theme.palette.mode === 'dark' ? '#1A2027' : '#fff',\n    }} >\n      <Grid container spacing={0} justifyContent=\"center\" alignItems=\"center\">\n\n\n        <Grid item md={7} >\n        <Item elevation={0} >\n        <Grid component=\"form\" noValidate onSubmit={handleSubmit} container spacing={2} justifyContent='center' alignItems='center' >\n\n        <Grid item xs={6} md={12}>\n        <Item elevation={0} ><Typography variant=\"h5\">お届け先</Typography></Item>\n        </Grid>\n        <Grid item xs={12} sm={12}>\n              <InputLabel id=\"demo-simple-select-label\">国</InputLabel>\n              <Select value={shippingCountry} fullWidth onChange={(e) => setShippingCountry(e.target.value)}\n                  id=\"demo-simple-select\"\n                  label=\"Age\"\n              >\n                {Object.entries(shippingCountries).map(([code, name]) => ({ id: code, label: name })).map((item) => (\n                  <MenuItem key={item.id} value={item.id}>\n                    {item.label}\n                  </MenuItem>\n                ))}\n              </Select>\n            </Grid>\n            <Grid item xs={12} sm={12}>\n            <InputLabel id=\"demo-simple-select-label\">都道府県</InputLabel>\n              <Select value={shippingSubdivision} fullWidth onChange={(e) => setShippingSubdivision(e.target.value)}\n                  labelId=\"demo-simple-select-label\"\n                  id=\"demo-simple-select\"\n                  label=\"Age\"\n              >\n                {Object.entries(shippingSubdivisions).map(([code, name]) => ({ id: code, label: name })).map((item) => (\n                  <MenuItem key={item.id} value={item.id}>\n                    {item.label}\n                  </MenuItem>\n                ))}\n              </Select>\n        </Grid>\n        <Grid item xs={12} sm={4}>\n        <TextField\n        required\n        fullWidth\n        id=\"address1\"\n        label=\"郵便番号\"\n        name=\"address1\"\n        onChange={(e) => setEmail(e.target.value)}\n        helperText=\"Enter your email\"\n        />\n        </Grid>\n        <Grid item xs={12} sm={8}>\n        <TextField\n        required\n        fullWidth\n        id=\"address1\"\n        label=\"住所\"\n        name=\"address1\"\n        onChange={(e) => setEmail(e.target.value)}\n        helperText=\"Enter your email\"\n        />\n        </Grid>\n    \n        <Grid item xs={6} md={12}>\n        <Item elevation={0} ><Typography variant=\"h5\">ご連絡先</Typography></Item>\n        </Grid>\n\n        <Grid item xs={12} sm={12}>\n        <TextField\n        required\n        fullWidth\n        id=\"lastname\"\n        label=\"姓\"\n        name=\"lastname\"\n        defaultValue={lastname}\n        onChange={(e) => setEmail(e.target.value)}\n        helperText=\"Enter your email\"\n        />\n        </Grid>\n\n        <Grid item xs={12} sm={12}>\n        <TextField\n        autoComplete=\"given-name\"\n        name=\"firstname\"\n        required\n        fullWidth\n        id=\"firstname\"\n        label=\"名\"\n        defaultValue={firstname}\n        onChange={(e) => setEmail(e.target.value)}\n        helperText=\"Enter your email\"\n        />\n        </Grid>\n\n        <Grid item xs={12}>\n        <TextField\n        required\n        fullWidth\n        id=\"email\"\n        label=\"メールアドレス（Gmail等のフリーメール推奨）\"\n        name=\"email\"\n        defaultValue={email}\n        onChange={(e) => setEmail(e.target.value)}\n        helperText=\"Enter your email\"\n        />\n        </Grid>\n\n      </Grid>\n      </Item>\n\n      <Grid item xs={6} md={12}>\n        <Item elevation={0} ><Typography variant=\"h5\">お支払い方法</Typography></Item>\n        </Grid>\n        <Grid item xs={6} md={12}>\n        <Item elevation={0} >\n        <Elements stripe={stripePromise}>\n        <ElementsConsumer>{({ elements, stripe }) => (\n          <form onSubmit={(e) => handleSubmit(e, elements, stripe)}>\n            <CardElement />\n            <br /> <br />\n            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n              <Button fullWidth type=\"submit\" variant=\"contained\" disabled={!stripe} style={{ backgroundColor: '#1C2331', color: '#FFFF', height:60 }} >\n              支払う {checkoutToken.live.subtotal.formatted_with_symbol}\n              </Button>\n            </div>\n          </form>\n        )}\n        </ElementsConsumer>\n        </Elements>\n        </Item>\n        </Grid>\n\n      </Grid>\n\n\n      <Grid item md={5} >\n      <Item elevation={0} >\n      <Grid item xs={6} md={12}>\n        <Item elevation={0} ><Typography variant=\"h5\">購入するアイテム</Typography></Item>\n        </Grid>\n      <Divider sx={{margin:'10px'}}/>\n      <Grid item xs={6} md={12}>\n        <Item elevation={0} ><ModalUnstyledDemo /></Item>\n        </Grid>\n      <Grid item xs={6} md={12}>\n        <Item elevation={0} ><Typography variant=\"h5\">合計:      JPY ￥6,100{cart.subtotal.formatted_with_symbol}</Typography></Item>\n        </Grid>\n      <Divider sx={{margin:'10px'}}/>\n         \n      </Item>\n      </Grid>\n\n\n      </Grid>\n    </Paper>\n  );\n}\n\n// for testing form fubmission\nconst handleSubmit = (event) => {\n  event.preventDefault();\n  const data = new FormData(event.currentTarget);\n  // eslint-disable-next-line no-console\n  console.log({\n    email: data.get('email'),\n    password: data.get('password'),\n  });\n};\n\n\n\n\n\n\nconst StyledModal = styled(ModalUnstyled)`\n  position: fixed;\n  z-index: 1300;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst Backdrop = styled('div')`\n  z-index: -1;\n  position: fixed;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  left: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  -webkit-tap-highlight-color: transparent;\n`;\n\nconst style = {\n  width: 400,\n  bgcolor: 'background.paper',\n  p: 2,\n  px: 4,\n  pb: 3,\n};\n\nfunction ModalUnstyledDemo() {\n  const [open, setOpen] = React.useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  return (\n    <div>\n      <Button variant=\"outlined\" type=\"button\" onClick={handleOpen}>\n        配送について🚚\n      </Button>\n      <StyledModal\n        aria-labelledby=\"unstyled-modal-title\"\n        aria-describedby=\"unstyled-modal-description\"\n        open={open}\n        onClose={handleClose}\n        BackdropComponent={Backdrop}\n      >\n        <Paper sx={style}>\n          <h2 id=\"unstyled-modal-title\">配送ポリシー</h2>\n          <p id=\"unstyled-modal-description\">ご注文からお届けまでの流れ🚚\n\nSTEP1. 商品のお手配（注文後4~6営業日）\n\nご注文（入金確認）完了後、翌営業日にメーカーへ発注\n\n→商品を検品し、丁寧に包装・梱包して発送の準備をしていきます\n\nSTEP2. 海外から国内倉庫へ向けて商品を発送（注文後7~10営業日）\n\n海外の発送拠点から税関を通り、日本へ向けて空輸\n\n→日本に到着後、再び税関を通り、国内倉庫へ輸送します\n\nSTEP3. 国内倉庫から発送（注文後14~26営業日）\n\n倉庫に商品が到着後、再び問題がないか念入りに検品をして梱包\n\n→配送業者を通してお客様のもとへ発送します</p>\n        </Paper>\n      </StyledModal>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}
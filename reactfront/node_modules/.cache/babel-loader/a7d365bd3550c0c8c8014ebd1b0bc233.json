{"ast":null,"code":"var _jsxFileName = \"/Users/satoshiaikawa/react-mui-bookstore-k8s/src/components/ProductView/productView.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport Typography from '@mui/material/Typography';\nimport Container from '@mui/material/Container';\nimport Grid from '@mui/material/Grid';\nimport { Button, Divider } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport { useState, useEffect } from \"react\";\nimport './styles.css';\nimport CategoryTags from './CategoryTags';\nimport axios from 'axios';\nimport Review from './Review';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst createMarkup = text => {\n  return {\n    __html: text\n  };\n};\n\nconst ProductView = _ref => {\n  _s();\n\n  let {\n    onAddToCart\n  } = _ref;\n  const [product, setProduct] = useState({});\n  const [reviews, setReviews] = useState([]); // useStateで配列の更新が上手くいかない\n  // https://zenn.dev/gunners6518/articles/4c06488cfa402e\n\n  const [categories, setCategories] = useState([]);\n  useEffect(() => {\n    const id = window.location.pathname.split(\"/\");\n    console.log(id);\n    fetchProduct(id[2]);\n    fetchReviews(id[2]);\n  }, []);\n\n  const fetchProduct = async id => {\n    //const response = await commerce.products.retrieve(id);\n    //console.log({ response });\n    //const { name, price, media, quantity, description } = response;\n    axios.get(`http://localhost:3001/api/products/` + id).then(res => {\n      const {\n        id,\n        name,\n        price,\n        media,\n        quantity,\n        description\n      } = res.data;\n      const cate = res.data.categories;\n      setProduct({\n        id,\n        name,\n        quantity,\n        description,\n        src: media.source,\n        price: price.formatted_with_symbol\n      });\n      setCategories(categories, []);\n      setCategories([...categories, cate]);\n    });\n  };\n\n  const fetchReviews = async productId => {\n    axios.get(`http://localhost:3003/api/reviews/` + productId).then(res => {\n      const revs = JSON.parse(JSON.stringify(res.data));\n      console.log(revs);\n      setReviews(reviews, []);\n      setReviews(reviews, revs);\n      console.log(reviews);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        className: \"product-view\",\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            md: 6,\n            className: \"image-wrapper\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: product.src,\n              alt: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            md: 5,\n            className: \"text\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h2\",\n              children: /*#__PURE__*/_jsxDEV(\"b\", {\n                children: product.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 79,\n                columnNumber: 40\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"p\",\n              dangerouslySetInnerHTML: createMarkup(product.description)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h3\",\n              color: \"secondary\",\n              children: [\"Price: \", /*#__PURE__*/_jsxDEV(\"b\", {\n                children: [\" \", product.price, \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 66\n              }, this), \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CategoryTags, {\n              categoriesa: categories\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              justifyContent: \"space-evenly\",\n              children: [/*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: true,\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"outlined\",\n                  size: \"small\",\n                  component: Link,\n                  to: \"/\",\n                  children: \"\\u623B\\u308B\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 87,\n                  columnNumber: 3\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 3\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: true,\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"contained\",\n                  size: \"small\",\n                  onClick: () => onAddToCart(product.id, 1),\n                  children: \"\\u8CB7\\u3044\\u7269\\u304B\\u3054\\u3078\\u5165\\u308C\\u308B\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 90,\n                  columnNumber: 3\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 3\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 2\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 20\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        color: \"black\",\n        children: \"\\u3053\\u306E\\u672C\\u306E\\u30EC\\u30D3\\u30E5\\u30FC\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 86\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 1,\n        children: reviews.map(rev => {\n          return /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            children: /*#__PURE__*/_jsxDEV(Review, {\n              review: rev\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 22\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 11\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 91\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProductView, \"mtrhJ+k7987F/iL0xq47E62LrOY=\");\n\n_c = ProductView;\nexport default ProductView;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductView\");","map":{"version":3,"sources":["/Users/satoshiaikawa/react-mui-bookstore-k8s/src/components/ProductView/productView.js"],"names":["React","Typography","Container","Grid","Button","Divider","Link","useState","useEffect","CategoryTags","axios","Review","createMarkup","text","__html","ProductView","onAddToCart","product","setProduct","reviews","setReviews","categories","setCategories","id","window","location","pathname","split","console","log","fetchProduct","fetchReviews","get","then","res","name","price","media","quantity","description","data","cate","src","source","formatted_with_symbol","productId","revs","JSON","parse","stringify","map","rev"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Typography from '@mui/material/Typography';\nimport Container from '@mui/material/Container';\nimport Grid from '@mui/material/Grid';\nimport { Button, Divider } from '@mui/material';\n\nimport { Link } from 'react-router-dom';\nimport { useState, useEffect } from \"react\";\nimport './styles.css'\nimport CategoryTags from './CategoryTags'\n\nimport axios from 'axios';\nimport Review from './Review';\n\n\nconst createMarkup = (text) => {\n    return { __html: text };\n  };\n\nconst ProductView = ({ onAddToCart }) => {\n\n    const [product, setProduct] = useState({});\n    const [reviews, setReviews] = useState([]);\n    // useStateで配列の更新が上手くいかない\n    // https://zenn.dev/gunners6518/articles/4c06488cfa402e\n    const [categories, setCategories] = useState([]);\n\n    useEffect(() => {\n      const id = window.location.pathname.split(\"/\");\n      console.log(id);\n      fetchProduct(id[2]);\n      fetchReviews(id[2]);\n    }, []);\n\n\n    const fetchProduct = async (id) => {\n        //const response = await commerce.products.retrieve(id);\n        //console.log({ response });\n        //const { name, price, media, quantity, description } = response;\n\n        axios.get(`http://localhost:3001/api/products/`+id)\n        .then(res => {\n          const { id, name, price, media, quantity, description } = res.data\n          const cate = res.data.categories\n          setProduct({\n            id, \n            name,\n            quantity,\n            description,\n            src: media.source,\n            price: price.formatted_with_symbol,\n          });\n          setCategories(categories,[])\n          setCategories([...categories, cate ]);\n        })\n      };\n\n      const fetchReviews = async (productId) => {\n        axios.get(`http://localhost:3003/api/reviews/`+productId)\n        .then(res => {\n          const revs = JSON.parse(JSON.stringify(res.data));\n          console.log(revs)\n          setReviews(reviews,[])\n          setReviews(reviews, revs );\n          console.log(reviews)\n        })\n      };\n\n    return (\n        <Grid container>\n        <Grid item>\n        <Container className=\"product-view\">\n          <Grid container>\n            <Grid item xs={12} md={6} className=\"image-wrapper\">\n              <img src={product.src} alt={product.name}\n              />\n            </Grid>\n            <Grid item xs={12} md={5} className=\"text\">\n              <Typography variant=\"h2\"><b>{product.name}</b></Typography>\n              <hr />\n              <Typography variant=\"p\" dangerouslySetInnerHTML={createMarkup(product.description)} />\n              <Typography variant=\"h3\" color=\"secondary\" >Price: <b> {product.price} </b> </Typography>\n              <CategoryTags categoriesa={categories} />\n              <br/>\n <Grid container justifyContent=\"space-evenly\">\n  <Grid item xs>\n  <Button variant=\"outlined\" size=\"small\" component={Link} to='/' >戻る</Button>\n  </Grid>\n  <Grid item xs>\n  <Button variant=\"contained\" size=\"small\" onClick={() => onAddToCart(product.id, 1)}>買い物かごへ入れる</Button>\n  </Grid>\n</Grid>\n            </Grid>\n          </Grid>\n        </Container>\n        </Grid>\n        \n        <Grid item><br/><Typography variant=\"h5\" color=\"black\" >この本のレビュー</Typography><br/><Grid container spacing={1}>{reviews.map((rev) => {\n        return (\n          <Grid item><Review review={rev} /></Grid>\n        );\n      })}</Grid></Grid>\n\n     </Grid>\n        \n      );\n    };\n    \n    export default ProductView;\n"]},"metadata":{},"sourceType":"module"}